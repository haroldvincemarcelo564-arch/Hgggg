-- Load Updated Rayfield Library (recommended and stable as of 2025)
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()

-- Load Main GUI directly (no key system)
local Window = Rayfield:CreateWindow({
    Name = "MARCELO SCRIPT",
    LoadingTitle = "MARCELO SCRIPT",
    LoadingSubtitle = "Powered by 67Rizzmas",
    ShowText = "Tap to Open MARCELO SCRIPT",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "MarceloScriptConfig",
        FileName = "Config"
    },
    ToggleUIKeybind = nil,
    Draggable = true
})

-- Main Features Tab
local MainTab = Window:CreateTab("Main Features", "home")

-- Noclip Toggle
MainTab:CreateToggle({
    Name = "Noclip",
    CurrentValue = false,
    Flag = "NoclipToggle",
    Callback = function(Value)
        local Player = game.Players.LocalPlayer
        local Character = Player.Character or Player.CharacterAdded:Wait()
        if Value then
            for _, part in pairs(Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
            local connection
            connection = game:GetService("RunService").Stepped:Connect(function()
                if not MainTab.Flags.NoclipToggle.CurrentValue then
                    connection:Disconnect()
                    return
                end
                for _, part in pairs(Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end)
        else
            for _, part in pairs(Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end
    end,
})

-- Fly Toggle Button
MainTab:CreateButton({
    Name = "Toggle Fly",
    Description = "Tap to enable/disable flying",
    Callback = function()
        local Player = game.Players.LocalPlayer
        local Character = Player.Character or Player.CharacterAdded:Wait()
        local RootPart = Character:FindFirstChild("HumanoidRootPart")
        local Humanoid = Character:FindFirstChild("Humanoid")
        if not RootPart or not Humanoid then return end

        if Player:GetAttribute("Flying") then
            Player:SetAttribute("Flying", false)
            if RootPart:FindFirstChild("FlyVelocity") then
                RootPart.FlyVelocity:Destroy()
            end
            Rayfield:Notify({Title = "Fly", Content = "Flying disabled!", Duration = 3})
        else
            Player:SetAttribute("Flying", true)
            local BodyVelocity = Instance.new("BodyVelocity")
            BodyVelocity.Name = "FlyVelocity"
            BodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
            BodyVelocity.Velocity = Vector3.new(0, 0, 0)
            BodyVelocity.Parent = RootPart

            local connection
            connection = game:GetService("RunService").Heartbeat:Connect(function()
                if not Player:GetAttribute("Flying") then
                    connection:Disconnect()
                    return
                end
                local moveDirection = Humanoid.MoveDirection * 50
                BodyVelocity.Velocity = moveDirection + Vector3.new(0, 5, 0)
            end)
            Rayfield:Notify({Title = "Fly", Content = "Flying enabled! Use movement controls.", Duration = 3})
        end
    end,
})

-- Chat Bypass Tab (unchanged)
local BypassTab = Window:CreateTab("Chat Bypass", "message")

BypassTab:CreateButton({
    Name = "Enable Simple Word Bypass",
    Description = "Bypasses common filtered words (including adult terms)",
    Callback = function()
        local bypassMap = {
            ["fuck"] = "fück",
            ["shit"] = "shіt",
            ["bitch"] = "bіtch",
            ["ass"] = "аss",
            ["nigga"] = "nіgga",
            ["nigger"] = "nіgger",
            ["damn"] = "dаmn",
            ["cunt"] = "cünt",
            ["faggot"] = "fаggot",
            ["retard"] = "retаrd",
            ["cum"] = "cüm",
            ["creampie"] = "creаmpie",
            ["bang"] = "bаng",
        }

        local oldChat = game:GetService("TextChatService").ChatInputBarConfiguration.TargetTextChannel.SendAsync
        game:GetService("TextChatService").ChatInputBarConfiguration.TargetTextChannel.SendAsync = function(self, text)
            for word, bypass in pairs(bypassMap) do
                text = text:gsub(word, bypass)
                    :gsub(word:upper(), bypass:upper())
                    :gsub(word:gsub("^%l", string.upper), bypass:gsub("^%l", string.upper))
            end
            oldChat(self, text)
        end
        Rayfield:Notify({Title = "Bypass", Content = "Simple word bypass enabled! Includes cum, creampie, bang ass.", Duration = 6})
    end,
})

BypassTab:CreateButton({
    Name = "Enable Advanced Bypass",
    Description = "Inserts invisible characters between letters",
    Callback = function()
        local zwsp = ""  -- Zero-width space
        local function bypassText(text)
            return text:gsub("(%a)", "%1"..zwsp):gsub(zwsp..zwsp.."+", zwsp)
        end

        local oldChat = game:GetService("TextChatService").ChatInputBarConfiguration.TargetTextChannel.SendAsync
        game:GetService("TextChatService").ChatInputBarConfiguration.TargetTextChannel.SendAsync = function(self, text)
            oldChat(self, bypassText(text))
        end
        Rayfield:Notify({Title = "Bypass", Content = "Advanced bypass enabled! Works on almost anything.", Duration = 5})
    end,
})

BypassTab:CreateButton({
    Name = "Info: Disable Bypass",
    Description = "How to turn off bypasses",
    Callback = function()
        Rayfield:Notify({Title = "Info", Content = "To fully disable bypasses, re-execute the script without pressing the bypass buttons.", Duration = 8})
    end,
})

-- Script Hubs Tab (all your existing universal hubs)
local HubsTab = Window:CreateTab("Script Hubs", "rocket")

-- (Your existing hub buttons here - Infinite Yield, Nameless Admin, Voidware, Rochip, Fox Hub, Ketamine, Owl Hub, Dark Hub, Vape V4, Blaze, Evo V2, Redz, Proxo)
-- Kept unchanged for brevity, but include them as in your original script

-- New FE Animations Tab
local FEAnimTab = Window:CreateTab("FE Animations", "zap")

-- FE Wally West (R15 reanimation GUI)
FEAnimTab:CreateButton({
    Name = "FE Wally West",
    Description = "R15 Wally West (The Flash) reanimation with emotes",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/kaisigma321/WallyWestFEGui/main/source"))()
        Rayfield:Notify({Title = "FE Anim", Content = "FE Wally West loaded! (R15 required)", Duration = 5})
    end,
})

-- FE Titan (Giant transformation)
FEAnimTab:CreateButton({
    Name = "FE Titan",
    Description = "FE Giant Titan transformation with animations",
    Callback = function()
        loadstring(game:HttpGet("https://pastebin.com/raw/VgFdegiZ"))()  -- Common working FE Titan source
        Rayfield:Notify({Title = "FE Anim", Content = "FE Titan loaded!", Duration = 5})
    end,
})

-- FE Noli Animations Pack (large troll/dance pack)
FEAnimTab:CreateButton({
    Name = "FE Noli Animations Pack",
    Description = "320+ FE animations (troll, dance, freaky, etc.) - Keyless",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/ExploitFin/AquaMatrix/refs/heads/AquaMatrix/AquaMatrix"))()
        Rayfield:Notify({Title = "FE Anim", Content = "FE Noli/Animation Pack loaded! (320+ anims)", Duration = 6})
    end,
})

Rayfield:Notify({
    Title = "MARCELO SCRIPT Loaded",
    Content = "Key system removed! Added FE Wally West, FE Titan, and FE Noli Animations Pack.",
    Duration = 6,
})
